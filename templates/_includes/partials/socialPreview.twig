{% set url = element.url|default(null) %}
{% set homepage = element.owner.uri == "__home__" %}

{% set globalSeoEntry = craft.entries({ section: 'seo', limit: 1 }).eagerly().one() %}
{% set globalSEO = globalSeoEntry.seo.eagerly().one() %}
{% set globalImage = globalSEO.seoImage.eagerly().one()|default(null) %}
{% set elementImage = element.seoImage.eagerly().one()|default(null) %}

{% set onGlobalEntry = globalSEO.id == element.id %}

{# Set description and image #}
{% set description = element.seoOverview ?? globalSEO.seoOverview ?? null %}
{% set description = description ? description|striptags|truncate(160) : null %}
{% set image = elementImage ?? globalImage ?? null %}

{# Make the title #}
{% set elementTitle =
    onGlobalEntry ? null :
    element.seoTitle ?? element.owner.title ?? null 
%}
{% set title = elementTitle ? siteName ~ ' â€“ ' ~ elementTitle : siteName %}

<div class="seo-preview">
    <h1 class="title">Preview</h1>
    <h2>Google</h2>
    <div class="google-card">
        <h3>{{ title }}</h3>
        <p class="url">{{ url }}</p>
        <p>{{ description }}</p>
    </div>
    <h2 class="social-card-title">Social Card</h2>
    <div class="social-card">
        {% if image %}
            {% set ogImage = {
                width: 1200,
                height: 630,
                quality: 75,
            } %}
            <img src="{{ image.url(ogImage) }}">
        {% endif %}
        <div class="inner">
            <h3>{{ title }}</h3>
            <p>{{ description }}</p>
            <p class="url">{{ url }}</p>
        </div>
    </div>
</div>
<style>
    .seo-preview > .title {
        font-size: 1rem;
        margin-bottom: 0.5em;
        text-transform: uppercase;
    }
    .seo-preview > .google-card {
        background-color: #F4F7FC;
        border: 1px solid #e5e7eb;
        padding: 1em;
        margin-bottom: 1em;
        border-radius: 5px;
    }
    .seo-preview > .google-card > h3 {
        font-size: 1rem;
        margin: 0em;
        font-weight: normal;
        color: #1a0dab;
        cursor: pointer;
        display: inline-block;
    }
    .seo-preview > .google-card > h3:hover {
        text-decoration: underline;
    }
    .seo-preview > .google-card > .url {
        color: #006621;
    }
    .seo-preview > .google-card > p {
        font-size: 0.8rem;
        margin: 0em;
    }
    .seo-preview > h2.social-card-title{
        margin-top: 2em;
    }
    .seo-preview > .social-card {
        background-color: #F4F7FC;
        border: 1px solid #e5e7eb;
        border-radius: 5px;
        overflow: hidden;
        max-width: 600px;
    }
    .seo-preview > .social-card > .inner {
        padding: 1em;
    }
    .seo-preview > .social-card > .inner > p {
        margin: 0em;
    }
    .seo-preview > .social-card > .inner > h3 {
        margin-bottom: 0.5em
    }
    .seo-preview > .social-card > .inner > p.url {
        margin-top: 0.5em;
        color: #8899a6;
    }
</style>